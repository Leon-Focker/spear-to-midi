# SPEAR to MIDI

A simple utility inspired by [Stephen Bradshaw's SPEAR-to-MIDI](https://github.com/stephenjbradshaw/SPEAR-to-MIDI) that interprets spectral analysis data created by SPEAR (http://www.klingbeil.com/spear/) and creates MIDI files based on this information.

The program reads text files in SPEAR's 'text - partials' format. These files contain time, frequency and amplitude data generated by SPEAR's sinusoidal partials analysis.

## Installation

Clone [this repository](https://github.com/Leon-Focker/spear-to-midi) or download the source code. Then either:

**Option 1:** Place the folder in your [Quicklisp local-projects directory](http://blog.quicklisp.org/2018/01/the-quicklisp-local-projects-mechanism.html), for example:
```
~/quicklisp/local-projects/
```

**Option 2:** Add the path manually in your Lisp session:
```
(push "/full/path/to/spear-to-midi/" asdf:*central-registry*)
```

Then load the system with:
```
(ql:quickload :spear-to-midi)
```

## Usage
* Create a spectral analysis using SPEAR. Use a relatively high 'Minimum amplitude threshold' value (e.g. -20dB) for best results.
* In SPEAR, under 'File' -> 'Export Format' select 'Text - Partials', then 'File' -> 'Export As...'
* In a Lisp environment where the spear-to-midi package is loaded you can then call: ```(spear-to-midi "Path-to-the/file-you-just-created.txt")```

## Data interpretation details

Normally the Midi notes are generated by taking the average of each partials parameters. I added functionality to split each partial into its individual timepoints, which can then be converted to notes. However, this generates a LOT of notes, so be careful with this feature.